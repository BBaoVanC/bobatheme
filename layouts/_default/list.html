{{ define "main" }}
{{ if or (eq .Kind "term") (eq .Kind "taxonomy") }}
<h1>
    {{ partial "icon.html" "filter" }}
    Filtering for "{{ .Title }}"
    {{ if eq .Kind "term" }}
    <span class="rss-link">
        {{ with .OutputFormats.Get "rss" }}
        <a href="{{ .Permalink }}">{{ partial "icon.html" "rss" }}</a>
        {{ end }}
    </span>
    {{ end }}
</h1>
{{ else }}
<h1>
    {{ .Title | markdownify }}
    <span class="rss-link">
        {{ with .OutputFormats.Get "rss" }}
        <a href="{{ .Permalink }}">{{ partial "icon.html" "rss" }}</a>
        {{ end }}
    </span>
</h1>
{{ end }}

{{ if eq .Kind "taxonomy" }}
<ul>
    {{ range .Pages }}
    <li>
        <a href="{{ .Permalink }}">{{ .Title | markdownify }}</a>
    </li>
    {{ end }}
</ul>

{{ else }}
{{ range .Paginator.Pages }}
<div class="post">
    <h2 class="post-title">
        <a href="{{ .Permalink }}">{{ .Title | markdownify }}</a>
    </h2>

    {{ if or .Date (.GetTerms "tags") }}
    <div class="post-metadata">
        {{ if .Date }}

        {{ partial "icon.html" "calendar" }}
        <time datetime="{{ .Date.Format "January 2, 2006" }}" pubdate>
            {{ .Date.Format "January 2, 2006" }}
        </time>

        {{ if ne .Lastmod .Date }}
        <time datetime="{{ .Lastmod.Format "2006-01-02" }}" pubdate>
            (Modified {{ .Lastmod.Format "January 2, 2006" }})
        </time>
        {{ end }}

        {{ end }}

        <span class="tags">
            {{ range (.GetTerms "tags") }}
            <span class="tag">
                {{ partial "icon.html" "tag" }}
                <a href="{{ .Permalink }}">{{ .LinkTitle }}</a>
            </span>
            {{ end }}
        </span>
    </div>
    {{ end }}

    {{ with .Resources.GetMatch "feature" }}
    <div class="post-image">
        <img src="{{ .Permalink }}" alt="{{ .Title }}" />
    </div>
    {{ end }}

    <div class="post-description">
        {{ if .Description }}
        {{ .Description | markdownify }}
        {{ else }}
        {{ .Summary | markdownify }}
        {{ end }}
    </div>

    <div class="readmore">
        <a href="{{ .Permalink }}">Read more &rarr;</a>
    </div>
</div>
{{ else }}
<div>
    No posts here!
</div>
{{ end }}

<div class="pagination">
    {{ template "_internal/pagination.html" . }}
</div>

{{ end }}

{{ end }}
